(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function e(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(s){if(s.ep)return;s.ep=!0;const a=e(s);fetch(s.href,a)}})();const l={apiKey:void 0,authDomain:void 0,databaseURL:void 0,projectId:void 0,storageBucket:void 0,messagingSenderId:void 0,appId:void 0};class h{constructor(){this.currentAPI="firebase",this.firebaseInitialized=!1;try{if(Object.values(l).every(t=>t))firebase.apps.length||firebase.initializeApp(l),this.db=firebase.database(),this.firebaseInitialized=!0,console.log("Firebase inicializado com sucesso");else throw new Error("Configuração do Firebase incompleta.")}catch(t){console.error("Erro ao inicializar Firebase:",t)}this.apis={firebase:{name:"Firebase",get:async t=>{if(!this.firebaseInitialized)throw new Error("Firebase não inicializado");try{return(await this.db.ref(`stats/${t}`).once("value")).val()||0}catch(e){return console.error("Erro Firebase get:",e),0}},increment:async(t,e=1)=>{if(!this.firebaseInitialized)throw new Error("Firebase não inicializado");try{return await this.db.ref(`stats/${t}`).transaction(s=>(s||0)+e),(await this.db.ref(`stats/${t}`).once("value")).val()||0}catch(r){return console.error("Erro Firebase increment:",r),0}}},demo:{name:"Dados Demo",data:{totalVisits:3500,todayVisits:85,discordClicks:120,langPt:450,langEn:300,langTr:150},get:async t=>(await new Promise(e=>setTimeout(e,300)),this.apis.demo.data[t]||0),increment:async(t,e=1)=>(await new Promise(r=>setTimeout(r,200)),this.apis.demo.data[t]=(this.apis.demo.data[t]||0)+e,this.apis.demo.data[t])}},this.counters={totalVisits:"totalVisits",todayVisits:"todayVisits_"+new Date().toISOString().split("T")[0],discordClicks:"discordClicks",langPt:"langPt",langEn:"langEn",langTr:"langTr",langEs:"langEs"}}async getCurrentAPI(){return this.apis[this.currentAPI]}async get(t){return await(await this.getCurrentAPI()).get(t)}async increment(t,e=1){return await(await this.getCurrentAPI()).increment(t,e)}setStatus(t,e){const r=document.getElementById(t);r&&(r.className=`status-indicator ${e?"status-online":"status-offline"}`)}showMessage(t,e=!1){const r=document.getElementById("statusMessage");r.innerHTML=`
      <div class="${e?"error-message":"success-message"}">
        ${t}
      </div>
    `,setTimeout(()=>{r.innerHTML=""},5e3)}formatNumber(t){return new Intl.NumberFormat("pt-BR").format(t)}updateLanguageProgress(t,e,r){const s=t+e+r;if(s>0){const a=t/s*100,i=e/s*100,o=r/s*100;document.getElementById("ptProgress").style.width=a+"%",document.getElementById("enProgress").style.width=i+"%",document.getElementById("trProgress").style.width=o+"%"}}async loadAllStats(){const t=document.querySelector(".stats-container");t.classList.add("loading");try{this.showMessage(`Carregando estatísticas via ${this.apis[this.currentAPI].name}...`);const e=await Promise.allSettled([this.get(this.counters.totalVisits),this.get(this.counters.todayVisits),this.get(this.counters.discordClicks),this.get(this.counters.langPt),this.get(this.counters.langEn),this.get(this.counters.langTr)]),[r,s,a,i,o,d]=e.map(n=>n.status==="fulfilled"?n.value:0);document.getElementById("totalVisits").textContent=this.formatNumber(r),document.getElementById("todayVisits").textContent=this.formatNumber(s),document.getElementById("discordClicks").textContent=this.formatNumber(a),document.getElementById("ptCount").textContent=this.formatNumber(i),document.getElementById("enCount").textContent=this.formatNumber(o),document.getElementById("trCount").textContent=this.formatNumber(d),this.updateLanguageProgress(i,o,d);const m=e.every(n=>n.status==="fulfilled");["totalStatus","todayStatus","discordStatus"].forEach(n=>{this.setStatus(n,m)}),document.getElementById("lastUpdate").textContent=new Date().toLocaleString("pt-BR"),document.getElementById("currentAPI").textContent=this.apis[this.currentAPI].name,this.showMessage(`✅ Estatísticas carregadas via ${this.apis[this.currentAPI].name}!`)}catch(e){console.error("Erro ao carregar estatísticas:",e),this.showMessage(`❌ Erro ao carregar via ${this.apis[this.currentAPI].name}`,!0)}finally{t.classList.remove("loading")}}switchAPI(t){this.currentAPI=t,document.querySelectorAll(".api-option").forEach(e=>{e.classList.remove("active")}),document.querySelector(`[data-api="${t}"]`).classList.add("active"),this.showMessage(`🔄 API alterada para ${this.apis[t].name}`),this.loadAllStats()}async trackVisit(){try{await this.increment(this.counters.totalVisits),await this.increment(this.counters.todayVisits),console.log("Visita rastreada com sucesso")}catch(t){console.error("Erro ao rastrear visita:",t)}}async trackLanguageChange(t){try{t==="pt"&&await this.increment(this.counters.langPt),t==="en"&&await this.increment(this.counters.langEn),t==="tr"&&await this.increment(this.counters.langTr),t==="es"&&await this.increment(this.counters.langEs),console.log(`Mudança de idioma para ${t} rastreada com sucesso`)}catch(e){console.error("Erro ao rastrear mudança de idioma:",e)}}async trackDiscordClick(){try{await this.increment(this.counters.discordClicks),console.log("Clique no Discord rastreado com sucesso")}catch(t){console.error("Erro ao rastrear clique no Discord:",t)}}}const c=new h;document.addEventListener("DOMContentLoaded",async()=>{setTimeout(async()=>{await c.trackVisit(),await c.loadAllStats(),setInterval(()=>{c.loadAllStats()},2*60*1e3)},1e3)});
